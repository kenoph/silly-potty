<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Senato</title>

    <script src="js/d3.js"></script>
    <script src="js/jsnetworkx.js"></script>
    <script src="js/d3.queue.v2.min.js"></script>
</head>
<body>
<style>
    html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
    }
    body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
    }
    #graph {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
    }
</style>

<svg id="graph"></svg>

<script>
    d3.queue = d3_queue.queue;

    var G = new jsnx.Graph();

    d3.queue()
            .defer(d3.json, "/data/senato/senatori.json")
            .defer(d3.json, "/data/senato/partiti.json" )
            .defer(d3.json, "/data/senato/adesioni.json").awaitAll(function (err, files) {

        var senatori = files[0];
        var partiti  = files[1];
        var adesioni = files[2];

        console.log(senatori);
        console.log(partiti);

        senatori.forEach(function (senatore) {
            G.addNode(senatore.senatore, {
                color: "#999",
                label: senatore.nome + " " + senatore.cognome,
                obj: senatore
            });
        });

        partiti.forEach(function (partito) {
            G.addNode(partito.partito, {
                color: "#000",
                label: partito.nomi[0],
                obj: partito
            });
        })

        draw();
    });

    function draw() {
        jsnx.draw(G, {
            element: '#graph',
            labels: function (d) {
                return d.data.label;
            },
            withLabels: true,
            nodeAttr: {
                r: 5
            },
            nodeStyle: {
                fill: function(d) {
                    return d.data.color;
                },
                stroke: 'none'
            },
            edgeStyle: {
                fill: '#999'
            }
        });
    }
</script>
</body>
</html>